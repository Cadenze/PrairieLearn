<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head', {pageNote: 'Preview', pageTitle: question.qid}); %>
    <%- include('../partials/mathjax'); %>
    <script src="/node_modules/socket.io-client/dist/socket.io.slim.js"></script>
    <script>
      document.urlPrefix = '<%= urlPrefix %>';
    </script>
    <% if (question.type != 'Freeform') { %>
    <script src="/javascripts/lodash.min.js"></script>
    <script src="/javascripts/require.js"></script>
    <script src="/localscripts/question.js"></script>
    <script src="/localscripts/question<%= effectiveQuestionType %>.js"></script>
    <% } %>
    <%- extraHeadersHtml %>
  </head>
  <body>
    <%- include('../partials/navbar'); %>
    <div class="container-fluid">
      <%- include('../partials/questionSyncErrorsAndWarnings'); %>
    </div>
    <div id="content" class="container">
      <div class="row">

        <% if (submission.score == null && authn_user.user_id != instance_question.manual_grading_user) { %>
        <div class="col-lg-12 col-sm-12">
          <div class="card mb-4">
            <div class="card-header bg-warning text-blue">
              <%=  grading_user.name + ' (' + grading_user.uid + ')'%> is currently grading this question
            </div>
          </div>
        </div>
        <% } %>

          <div class="col-lg-9 col-sm-12">
              <%- include('../partials/question', {question_context: 'instructor'}); %>
          </div>

          <div class="col-lg-3 col-sm-12">
              <%- include('../partials/instructorGradingPanel', {question_context: 'instructor'}); %>
              <div class="card mb-4">
                  <div class="card-header bg-secondary text-white">Student view placeholder</div>
                  <div class="card-body">
                      <div class="d-flex justify-content-center">
                          In student views this area is used for assessment and score info.
                      </div>
                  </div>
              </div>
              <%- include('../partials/instructorInfoPanel', {question_context: 'instructor'}); %>
          </div>
      </div>

        <!-- Hidden Modal: Conflicting Submission Panel -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg">Large modal</button>

        <div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-lg">
            <div class="modal-header" style="background-color: #fff">
              <h4>Conflicting Submissions</h4>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">Ã—</span>
              </button>
            </div>
            <div class="modal-content">
              <div id="content" class="container">
                <div class="row">
                    <div class="col-lg-6 col-sm-12">
                        <%- include('../partials/instructorGradingPanel', {diff: 'Current', submission: {graded_by: '', feedback: '', score: 0}, question_context: 'instructor'}); %>
                    </div>
                    <div class="col-lg-6 col-sm-12">
                      <%- include('../partials/instructorGradingPanel', {diff: 'Incoming', submission: {graded_by: '', feedback: '', score: 0}, question_context: 'instructor'}); %>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>
    <script>
      $('form').submit((e) => {
        e.preventDefault();
        $.ajax({
          type: 'POST',
          url: './manual_grading',
          data: $('form').serialize(),
          statusCode: {
            409: () => {
              console.log('the data', data)
            }
          }
        });        
      })
    </script>
  </body>
</html>
